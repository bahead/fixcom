/**
 * Author: shrewmus shrewmus@yandex.ru (shrewmus@wrkshop.biz)
 * Date: 22.05.12
 * Time: 0:24
 * Copyright 2012
 */
var menuPad=function(){function a(a){var b={mabout:{wid:47,dlt:18},mserv:{wid:62,dlt:48},mconts:{wid:86,dlt:72}};if(void 0==a){if("mainAnch"==c)return{dx:-100,wid:0};a=$("#mcont > .active").get(0)}var e=void 0==a?0:$(a).offset().left,e=Math.abs($("#mcont").offset().left-e),e=e+parseInt(b[$(a).attr("id")].dlt);return{dx:e,wid:parseInt(b[$(a).attr("id")].wid)}}function b(b){b="mainAnch"!=b.id?a(b):a();$("#mpad").show();$("#mpad").stop().animate({left:b.dx,width:b.wid,opacity:1},500,"easeOutBack")}var c=
"mainAnch";return{startPos:function(){var b=a();$("#mpad").css("left",b.dx);$("#mpad").css("width",b.wid);$("#mpad").css("opacity",0);$("#mpad").hide()},free:function(){var b=a();"mainAnch"==c?$("#mpad").stop().animate({left:b.dx,width:b.wid,opacity:0},500,"easeOutBack",function(){$("#mpad").hide()}):$("#mpad").stop().animate({left:b.dx,width:b.wid},500,"easeOutBack")},moveHere:b,setActive:function(a){c=a.id;b(a)}}},mBar=new menuPad;function initDraggable(){$("#movie_button").css("left",0);$("#move_button").draggable({axis:"x",containment:"parent",stop:checkStopDrag,drag:checkDrag})}var sendFlag=!1,resetFlag=!1;
function checkDrag(a){var b=$(a.target).position().left,a=Math.floor($(a.target).parent().width()),c=2*a/3;b>=a/4&&b<c?$("#move_info").html("\u0422\u044f\u043d\u0438 \u0434\u043e \u043a\u043e\u043d\u0446\u0430"):b>=c?$("#move_info").html(""):$("#move_info").html("\u0422\u044f\u043d\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c");b>=a-57&&!sendFlag&&(sendFlag=!0,b=checkDefFieldsVal(),b.err?showError(b.fields):(b=getFormData(),jQuery.post("/main/check",
b,resValidate)))}function checkStopDrag(a){var b=$(a.target).position().left,c=Math.floor($(a.target).parent().width());if(b<c-57||!0==resetFlag)$(a.target).stop().animate({left:0},1E3,"easeOutBounce"),$("#move_info").html("\u0422\u044f\u043d\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")};var contArr=["main","about","serv"],fields={name:"\u041a\u0430\u043a \u0432\u0430\u0441 \u0437\u043e\u0432\u0443\u0442?",email:"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043f\u043e\u0447\u0442\u0430",phone:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",descr:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u043e\u043c\u043a\u0438"};
function initThis(){hypen();$(".pr_pr").each(function(b,a){$(a).removeClass("pr_pr");$(a).addClass("pr_rub");$(a).html("<span>b</span>")});$("#sendMsg").hide();$("#arr_up").click(function(a){$("html,body").animate({scrollTop:0},1E3,null,function(){var a=$("#content > .active").get(0);switch(a.id){case "main":a=$("#mainAnch").get(0);break;case "serv":a=$("#mserv").get(0);break;case "about":a=$("#mabout").get(0)}mBar.setActive(a)});a.preventDefault()});$.browser.opera&&($(".sp").each(function(a,b){$(b).css("line-height",
"26px")}),$(".sp1 a,.sp1 span").each(function(a,b){$(b).css("line-height","25px")}),$(".tx .sp1 span, .tx .sp1 a").each(function(a,b){$(b).css("line-height","12px")}),$("#bah a").css("line-height","16px"));for(var a in fields){var b=$("#e_"+a).get(0);void 0!=b&&($("#"+a).change(function(a){$("#e_"+$(a.target).attr("id")).hide()}),$(b).hide())}$(".tmel, #mainAnch").each(function(a,b){var d="0 ";switch(b.id){case "mserv":d="50% ";break;case "mconts":d="100% "}$(b).hover(function(a){$("#"+$(a.currentTarget).attr("id")+
"R").css("background-position",d+"-12px");$("#"+$(a.currentTarget).attr("id")+"E").css("background-position",d+"-41px");mBar.moveHere(a.currentTarget)},function(a){$("#"+$(a.currentTarget).attr("id")+"R").css("background-position",d+"0");$("#"+$(a.currentTarget).attr("id")+"E").css("background-position",d+"-29px");mBar.free()})});$("#contForm input,#contForm textarea").each(function(a,b){$(b).blur(function(){var a=$(b).val(),c=$(b).attr("name");jQuery.trim(a).length==0&&$(b).val(fields[c])});$(b).focus(function(){if(resetFlag){initDraggable();
resetFlag=sendFlag=false}var a=$(b).attr("name");$(b).val()==fields[a]&&$(b).val("")})});$(".f_addr").click(function(){window.open("/map","_blank")});$("#f_vk").click(function(){window.open("http://vk.com/fixcom","_blank")});$("#tmenu .tmel").each(function(a,b){$(b).bind("click",changeMenuActive)});$("#mconts").bind("click",contactsScroll);$("#mabout").click("about",movableMove);$("#mainAnch").click("main",function(a){$("#content .movable").each(function(a,b){$(b).hasClass("active")&&$(b).removeClass("active")});
$("#main").addClass("active");movableMove(a)});$("#mserv").click("serv",movableMove);$("#descr").autoResize();initDraggable();$(".cl_lnk").each(function(a,b){if($.browser.opera){$(b).css("vertical-align","inherit");$(b).find("span").css("vertical-align","inherit");$(b).find("a").css("vertical-align","inherit")}});setTimeout(prepClients,500);setTimeout(mBar.startPos,500)}
function hypen(){$(".hyp").each(function(a,b){var c=$(b).html(),f=RegExp("([\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f])([\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f][\u0430\u0431\u0432\u0433\u0434\u0435\u0451\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e\u044f])","ig"),d=RegExp("([\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f][\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449])([\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f])",
"ig"),e=RegExp("([\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f])([\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f])","ig"),g=RegExp("([\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f][\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449])([\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f])",
"ig"),h=RegExp("([\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f][\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449])([\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0431\u0432\u0433\u0434\u0436\u0437\u043a\u043b\u043c\u043d\u043f\u0440\u0441\u0442\u0444\u0445\u0446\u0447\u0448\u0449][\u0430\u0435\u0451\u0438\u043e\u0443\u044b\u044d\u044e\u044f])",
"ig"),c=c.replace(RegExp("([\u0439\u044a\u044c])([\u0430\u0431\u0432\u0433\u0434\u0435\u0451\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e\u044f][\u0430\u0431\u0432\u0433\u0434\u0435\u0451\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e\u044f])","ig"),"$1&shy;$2"),c=c.replace(f,"$1&shy;$2"),c=c.replace(d,
"$1&shy;$2"),c=c.replace(e,"$1&shy;$2"),c=c.replace(g,"$1&shy;$2"),c=c.replace(h,"$1&shy;$2");$(b).html(c)})};function getOS(){return os={name:(/(win|mac|linux|sunos|solaris|iphone)/.exec(navigator.platform.toLowerCase())||[u])[0].replace("sunos","solaris")}};var clOffset;function prepClients(){$("#client_list ul > li").each(function(a,b){1==a%2&&$(b).addClass("zz")});$("#client_list").mousemove(clMMove);clOffset=$("#client_list").offset()}function clMMove(a){var a=(a.pageY-$("#client_list").offset().top)/$("#client_list").height(),b=$("#client_list ul").height()-$("#client_list").height();0<b&&(b*=-a,0.99<=a&&(b-=4),$("#client_list ul").css("top",b))};function calckContentPositions(a){0<=a.indexOf("Anch")&&(a=a.substring(0,a.indexOf("Anch")));for(var b in contArr)if(contArr[b]==a)break;var a=[],c;for(c in contArr){var f=0;c!=b&&(f=c-b);a[c]=1040*f}return a}function movableMove(a){a.preventDefault();moveContent(a.data);"mainAnch"==a.currentTarget.id&&mBar.setActive(a.currentTarget);return!1}
function moveContent(a){var b=calckContentPositions(a);$("#content .movable").each(function(a,b){$(b).hasClass("active")&&$(b).removeClass("active")});$("#"+a).addClass("active");for(var c in contArr)$("#"+contArr[c]).stop().animate({left:b[c]},500,"easeOutQuad")}function contactsScroll(a){var b=$("#contacts").offset().top;$("html,body").animate({scrollTop:b},1E3);a.preventDefault()}
function changeMenuActive(){$("#tmenu .tmel").each(function(a,b){$(b).hasClass("active")&&$(b).removeClass("active")});$(this).addClass("active");mBar.setActive($("#mcont > .active").get(0))};$(document).ready(setFieldsHover);
function setFieldsHover(){$(".fld_cent > input, .fld_cent > textarea").each(function(a,b){var c=[".fld_tl"," .fld_tr",".fld_bl",".fld_br"];$(b).blur(function(){clearFieldsHover(b)});$(b).focus(function(){var a=$(b).parent().parent();$(a).find(".fld_cent").css("background","#101112");for(var d=0;4>d;d++)$(a).find(c[d]).css("background-image","url(assets/images/ff_bg_h.png)");$(a).find(".fld_t").css("background-image","url(assets/images/fbg_t_h.png)");$(a).find(".fld_b").css("background-image","url(assets/images/fbg_b_h.png)");
$(a).find(".fld_l").css("background-image","url(assets/images/fbg_l_h.png)");$(a).find(".fld_r").css("background-image","url(assets/images/fbg_r_h.png)")})})}
function clearFieldsHover(a){var b=[".fld_tl"," .fld_tr",".fld_bl",".fld_br"],a=$(a).parent().parent();$(a).find(".fld_cent").css("background","");for(var c=0;4>c;c++)$(a).find(b[c]).css("background-image","");$(a).find(".fld_t").css("background-image","");$(a).find(".fld_b").css("background-image","");$(a).find(".fld_l").css("background-image","");$(a).find(".fld_r").css("background-image","")}
function checkDefFieldsVal(){var a=getFormData(),b={err:!1,fields:{}},c;for(c in a)b.fields[c]={},b.fields[c].val=a[c],a[c]==fields[c]&&(b.fields[c].error=!0,b.err=!0);return b}function resValidate(a){resetFlag=sendFlag=!1;$("#move_button").stop().animate({left:0},5);$("#move_button").draggable("destroy");a=jQuery.parseJSON(a);a.err?showError(a.fields):($("#sendMsg").height($("#contForm").height()),$("#sendMsg").show(),$("#contForm").hide(),setTimeout(retForm,5E3))}
function showError(a){for(var b in a)void 0!=fields[b]&&($("#"+b).val(a[b].val),!0==a[b].error?$("#e_"+b).show():$("#e_"+b).hide());$("#move_button").stop().animate({left:0},5);$("#move_button").draggable("destroy");resetFlag=!0;initDraggable();$("#move_info").html("\u0422\u044f\u043d\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")}function getFormData(){var a={},b;for(b in fields)a[b]=$("#"+b).val();return a}
function retForm(){$("#sendMsg").hide();$("#contForm").show();$("#contForm input, #contForm textarea").each(function(a,b){var c=$(b).attr("name");$("#e_"+c).hide();$(b).val(fields[c]);clearFieldsHover(b)});initDraggable();sendFlag=!1};
